{% extends "base/tmp_base.html" %}
{% load staticfiles %}

{% block head %}
<style type="text/css">
    #map-canvas { width: 100%; height: 500px; margin: 0; padding: 0;}
    #map-canvas img {max-width: none;}
</style>
{% endblock %}


{% block title %}Create Project{% endblock %}

{% block body %}

<div class='row'>
    <div class='large-12 columns'>
        <h1>Create Project</h1>
    </div>
</div>
<div class="row white-section">
    <div class="large-12 columns">
        <form method="POST" enctype="multipart/form-data">
      		{% csrf_token %}
      		{% for error in form.non_field_errors %}
        	<div data-alert class="alert-box alert">
            	{{ error }}
            	<a href="#" class="close">&times;</a>
          	</div>
        	{% endfor %}

            <div class="row">
                <div class="medium-12 columns">
                    {% include "base/partials/tooltip_formfield.html" with field=form.title %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.funding_goal %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.location %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.impact_power %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.end_date %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.video_url %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.cover_photo %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.org_name %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.mission_statement %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.org_start_date %}
                    {% include "base/partials/tooltip_formfield.html" with field=form.org_about %}
                    <div class="hide">
                        {% include "base/partials/tooltip_formfield.html" with field=form.location_latitude %}
                        {% include "base/partials/tooltip_formfield.html" with field=form.location_longitude %}
                    </div>
                </div>
        	</div>
            <div class="row">
                <div class="medium-8 columns">
                    <div id="map-canvas"></div>
                </div>
            </div>
            <button class="large right" id="save_project" type="submit">Save</button>
        </form>
    </div>
</div>

{% endblock %}

{% block javascripts %}
<!-- Initializes the Google Map / Location Selection -->
<script type="text/javascript"
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDVDPi1SXm3qKyvmE5i9XeO1Gs5WjK7SJE&libraries=places">
</script>
<script src="{% static 'js/typeahead.bundle.js' %}"></script>
<script src="{% static 'js/typeahead-addresspicker.js' %}"></script>
<script type="text/javascript">
    $( function() {
        // instantiate the addressPicker suggestion engine (based on bloodhound)
        var addressPicker = new AddressPicker({map: {id: '#map-canvas', displayMarker: true}, zoomForLocation: 18, draggable: true, reverseGeocoding: true, autocompleteService: {componentRestrictions: {country: 'US'}}});

        // instantiate the typeahead UI
        $('#id_location').typeahead(null, {
            displayKey: 'description',
            source: addressPicker.ttAdapter()
        });
        addressPicker.bindDefaultTypeaheadEvent($('#id_location'))
        $(addressPicker).on('addresspicker:selected', function (event, result) {
            $('#id_location_latitude').val(result.lat());
            $('#id_location_longitude').val(result.lng());
            console.log("SUCCESS!");
        })
    });
</script>

{% endblock %}
